##################################   Script for training a PINN   ########################################

#Import stuff
import torch.nn as nn
from PINN_Loop import train_pinn_with_Adam

train_pinn_with_Adam(
    model_name = "PINN_branched",
    shared_layers = [2, 60, 60, 60, 60,],
    velocity_layers = [60, 60, 60, 60, 2], 
    pressure_layers = [60, 60, 60, 60, 1], 
    activation = nn.Tanh(), 
    use_xavier = True, 
    N_walls=1000,
    N_inlet=200,
    N_outlet=200,
    N_cylinder=400,
    N_collocation=49152,
    L_total=1.0,
    pipe_radius=0.2,
    cylinder_radius=0.05,
    cylinder_center=(0.2, 0.0),  
    margin=0.01,  
    lr_shared = 0.001,
    lr_velocity = 0.001,
    lr_pressure = 0.0005,
    beta_1 = 0.89,
    beta_2 = 0.98,
    lr_drop_epoch = 5000,
    gamma= 0.5,
    epoch_start = 0,
    epoch_end = 101,
    #dynamic_weight_warmup=1000, 
    #dynamic_weight_step=2000,
    batch_size= 16384,
    Re = 5,
    U_max= 1.0,
    sections = [
        ("Pipe", 0, 1.0)
    ],
    lambda_x_mom = 1.0,
    lambda_y_mom = 1.0,
    lambda_cont = 1.0,
    lambda_inlet = 1.0,
    lambda_outlet = 1.0,
    lambda_wall = 1.0,
    )

train_pinn_with_Adam(
    model_name = "PINN",
    shared_layers = [2, 60, 60, 60, 60, 60, 60, 60, 60, 60, 3],
    velocity_layers = [2], 
    pressure_layers = [1], 
    activation = nn.Tanh(), 
    use_xavier = True, 
    N_walls=1000,
    N_inlet=200,
    N_outlet=200,
    N_cylinder=400,
    N_collocation=49152,
    L_total=1.0,
    pipe_radius=0.2,
    cylinder_radius=0.05,
    cylinder_center=(0.2, 0.0),  
    margin=0.01,  
    lr_shared = 0.001,
    lr_velocity = 0.001,
    lr_pressure = 0.0005,
    beta_1 = 0.89,
    beta_2 = 0.98,
    lr_drop_epoch = 5000,
    gamma= 0.5,
    epoch_start = 0,
    epoch_end = 51,
    #dynamic_weight_warmup=1000, 
    #dynamic_weight_step=2000,
    batch_size= 16384,
    Re = 5,
    U_max= 1.0,
    sections = [
        ("Pipe", 0, 1.0)
    ],
    lambda_x_mom = 1.0,
    lambda_y_mom = 1.0,
    lambda_cont = 1.0,
    lambda_inlet = 1.0,
    lambda_outlet = 1.0,
    lambda_wall = 1.0,
    )

